<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-16">
    <title>Procedure Details</title>
    <LINK HREF="RadGrid_Office2007.css" REL="stylesheet" TYPE="text/css">
    <LINK HREF="RadTabStrip.css" REL="stylesheet" TYPE="text/css">
    <LINK HREF="RadTabStrip_Office2007.css" REL="stylesheet" TYPE="text/css">
  </head>
  <body class="RadGrid RadGrid_Office2007">
    <table cellspacing="0" cellpadding="0" style="width:100%">
      <tr>
        <td>
          <div id="RadTabStrip1" class="RadTabStrip RadTabStrip_Office2007 RadTabStripTop_Office2007">
            <div class="rtsLevel rtsLevel1">
              <ul class="rtsUL">
                <li class="rtsLI rtsFirst rtsLast"><a class="rtsLink rtsSelected" href="#"><span class="rtsOut"><span class="rtsIn"><span class="rtsTxt"><font style="font-weight:bold" size="2.5px">Procedure Details</font></span></span></span></a></li>
              </ul>
            </div>
          </div>
        </td>
      </tr>
      <tr>
        <td style="border-top:solid 0px #8db2e3; border-right:solid 3px #8db2e3; border-bottom:solid 1px #8db2e3; border-left:solid 1px #8db2e3; padding:10px;">
          <font style="font-weight:bold" size="2px">Description</font>
          <hr class="RadGrid RadGrid_Office2007">
          <font style="font-weight:normal" size="2px"></font><br><br><font style="font-weight:bold" size="2px">Procedure Properties</font>
          <hr class="RadGrid RadGrid_Office2007">
          <div class="RadGrid RadGrid_Office2007" style="width:30%;">
            <table class="MasterTable_Office2007" cellspacing="0" style="width:100%;border-collapse:collapse;table-layout:auto;empty-cells:show;" id="ListOfTables">
              <thead>
                <tr class="GridRow_Office2007">
                  <th class="GridHeader_Office2007" width="20%">Name</th>
                  <th class="GridHeader_Office2007" width="80%">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr class="GridRow_Office2007">
                  <td>Name</td>
                  <td>CreateOrganization</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>Schema</td>
                  <td>dbo</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>Creation Date</td>
                  <td>2006/12/4 下午 06:24:40</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>Last Altered</td>
                  <td>2011/8/11 上午 11:37:52</td>
                </tr>
              </tbody>
            </table>
          </div><br><font style="font-weight:bold" size="2px">Parameter(s)</font>
          <hr class="RadGrid RadGrid_Office2007">
          <div class="RadGrid RadGrid_Office2007" style="width:50%;">
            <table class="MasterTable_Office2007" cellspacing="0" style="width:100%;border-collapse:collapse;table-layout:auto;empty-cells:show;" id="ListOfTables">
              <thead>
                <tr class="GridRow_Office2007">
                  <th class="GridHeader_Office2007" width="10%">Name</th>
                  <th class="GridHeader_Office2007" width="10%">Data Type</th>
                  <th class="GridHeader_Office2007" width="10%">Max Length</th>
                </tr>
              </thead>
              <tbody>
                <tr class="GridRow_Office2007">
                  <td>@Addr</td>
                  <td>nvarchar</td>
                  <td>256</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@CompanyID</td>
                  <td>int</td>
                  <td>
                                 
                              </td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@CompanyName</td>
                  <td>nvarchar</td>
                  <td>128</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@ContactEmail</td>
                  <td>nvarchar</td>
                  <td>50</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@ContactFax</td>
                  <td>nvarchar</td>
                  <td>20</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@ContactMobilePhone</td>
                  <td>nvarchar</td>
                  <td>20</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@ContactName</td>
                  <td>nvarchar</td>
                  <td>50</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@ContactPhone</td>
                  <td>nvarchar</td>
                  <td>20</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@ContactTitle</td>
                  <td>nvarchar</td>
                  <td>16</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@EnglishAddr</td>
                  <td>nvarchar</td>
                  <td>256</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@EnglishName</td>
                  <td>nvarchar</td>
                  <td>50</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@EnglishRegAddr</td>
                  <td>nvarchar</td>
                  <td>256</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@Fax</td>
                  <td>nvarchar</td>
                  <td>50</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@InvoiceSignature</td>
                  <td>nvarchar</td>
                  <td>64</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@LogoURL</td>
                  <td>nvarchar</td>
                  <td>200</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@Phone</td>
                  <td>nvarchar</td>
                  <td>20</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@ReceiptNo</td>
                  <td>nvarchar</td>
                  <td>10</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@RegAddr</td>
                  <td>nvarchar</td>
                  <td>256</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@UndertakerFax</td>
                  <td>nvarchar</td>
                  <td>20</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@UndertakerID</td>
                  <td>nvarchar</td>
                  <td>16</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@UndertakerMobilePhone</td>
                  <td>nvarchar</td>
                  <td>20</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@UndertakerName</td>
                  <td>nvarchar</td>
                  <td>50</td>
                </tr>
                <tr class="GridRow_Office2007">
                  <td>@UndertakerPhone</td>
                  <td>nvarchar</td>
                  <td>20</td>
                </tr>
              </tbody>
            </table>
          </div><br><font style="font-weight:bold" size="2px">Recordset(s)</font>
          <hr class="RadGrid RadGrid_Office2007">
          <div class="RadGrid RadGrid_Office2007" style="width:50%;">
            <table class="MasterTable_Office2007" cellspacing="0" style="width:100%;border-collapse:collapse;table-layout:auto;empty-cells:show;" id="ListOfTables">
              <thead>
                <tr class="GridRow_Office2007">
                  <th class="GridHeader_Office2007" width="10%">Name</th>
                  <th class="GridHeader_Office2007" width="10%">Data Type</th>
                  <th class="GridHeader_Office2007" width="10%">Max Length</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div><br><font style="font-weight:bold" size="2px">SQL</font>
          <hr class="RadGrid RadGrid_Office2007">
          <div class="RadGrid RadGrid_Office2007" style="width:100%;">
            <table class="MasterTable_Office2007" cellspacing="0" style="width:100%;border-collapse:collapse;table-layout:auto;empty-cells:show;" id="ListOfTables">
              <thead>
                <tr class="GridRow_Office2007">
                  <th class="GridHeader_Office2007" width="100%">Creation Script</th>
                </tr>
              </thead>
              <tbody>
                <tr class="GridRow_Office2007">
                  <td>
                    <pre>SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON

CREATE PROCEDURE [dbo].[CreateOrganization]
	(
		@ContactName	 nvarchar( 50),		--ContactName
		@Fax	 nvarchar( 50),				--Fax
		@LogoURL	 nvarchar( 200),		--LogoURL
		@CompanyName	 nvarchar( 128),	--CompanyName
		@ReceiptNo	 nvarchar( 10),			--ReceiptNo
		@Phone	 nvarchar( 20),				--Phone
		@ContactFax	 nvarchar( 20),			--ContactFax
		@ContactPhone	 nvarchar( 20),		--ContactPhone
		@ContactMobilePhone	 nvarchar( 20),	--ContactMobilePhone
		@RegAddr	 nvarchar( 256),		--RegAddr
		@UndertakerName	 nvarchar( 50),		--UndertakerName
		@Addr	 nvarchar( 256),			--Addr
		@EnglishName	 nvarchar( 50),		--EnglishName
		@EnglishAddr	 nvarchar( 256),	--EnglishAddr
		@EnglishRegAddr	 nvarchar( 256),	--EnglishRegAddr
		@ContactEmail	 nvarchar( 50),		--ContactEmail
		@UndertakerPhone	 nvarchar( 20),	--UndertakerPhone
		@UndertakerFax	 nvarchar( 20),		--UndertakerFax
		@UndertakerMobilePhone	 nvarchar( 20),	--UndertakerMobilePhone
		@InvoiceSignature	 nvarchar( 64),	--InvoiceSignature
		@UndertakerID		nvarchar(16)	=	null,
		@ContactTitle		nvarchar(16)	=	null,
		@CompanyID	 int		 			--CompanyID
	)
AS
	/* SET NOCOUNT ON */
	if @CompanyID = 0 
	begin
		INSERT INTO Organization 
			(
				ContactName,
				Fax,
				LogoURL,
				CompanyName,
				ReceiptNo,
				Phone,
				ContactFax,
				ContactPhone,
				ContactMobilePhone,
				RegAddr,
				UndertakerName,
				Addr,
				EnglishName,
				EnglishAddr,
				EnglishRegAddr,
				ContactEmail,
				UndertakerPhone,
				UndertakerFax,
				UndertakerMobilePhone,
				InvoiceSignature,
				ContactTitle,
				UndertakerID	
			) VALUES 
			(	
				@ContactName,
				@Fax,
				@LogoURL,
				@CompanyName,
				@ReceiptNo,
				@Phone,
				@ContactFax,
				@ContactPhone,
				@ContactMobilePhone,
				@RegAddr,
				@UndertakerName,
				@Addr,
				@EnglishName,
				@EnglishAddr,
				@EnglishRegAddr,
				@ContactEmail,
				@UndertakerPhone,
				@UndertakerFax,
				@UndertakerMobilePhone,
				@InvoiceSignature,
				@ContactTitle,
				@UndertakerID
			)
			
			RETURN IDENT_CURRENT('Organization')
		end
		else
		begin
			UPDATE Organization 
				SET 
					ContactName = @ContactName,
					Fax = @Fax,
					LogoURL = @LogoURL,
					CompanyName = @CompanyName,
					ReceiptNo = @ReceiptNo,
					Phone = @Phone,
					ContactFax = @ContactFax,
					ContactPhone = @ContactPhone,
					ContactMobilePhone = @ContactMobilePhone,
					RegAddr = @RegAddr,
					UndertakerName = @UndertakerName,
					Addr = @Addr,
					EnglishName = @EnglishName,
					EnglishAddr = @EnglishAddr,
					EnglishRegAddr = @EnglishRegAddr,
					ContactEmail = @ContactEmail,
					UndertakerPhone = @UndertakerPhone,
					UndertakerFax = @UndertakerFax,
					UndertakerMobilePhone = @UndertakerMobilePhone,
					InvoiceSignature = @InvoiceSignature,
					ContactTitle = @ContactTitle,
					UndertakerID = @UndertakerID
				WHERE 
					CompanyID = @CompanyID			
					
			return @CompanyID
		end
		

</pre>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </td>
      </tr>
    </table>
  </body>
</html>